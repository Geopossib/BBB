/**
 * @file Firestore Security Rules
 * @description This ruleset enforces a public read, admin-write model for all content collections.
 *
 * Data Structure:
 * - All content (articles, videos, audios, liveMeetings) is stored in top-level collections.
 *
 * Key Security Decisions:
 * - Unauthenticated users can read all content collections (articles, videos, audios, liveMeetings).
 * - Only authenticated users can create, update, and delete content.  There is no role based authentication implemented in the application. Assumes an admin role can be adopted by any signed in user.
 * - No data shape validation is performed in this prototype, only ownership validation on writes.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to articles and restricts write access to authenticated users.
     * @path /databases/{database}/documents/articles/{articleId}
     * @allow (get, list) Unauthenticated users can read articles.
     * @allow (create, update, delete) Authenticated users can create, update, and delete articles.
     * @deny (create, update, delete) Unauthenticated users cannot create, update, or delete articles.
     * @principle Allows public reads with authenticated-user-only writes.
     */
    match /articles/{articleId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to videos and restricts write access to authenticated users.
     * @path /databases/{database}/documents/videos/{videoId}
     * @allow (get, list) Unauthenticated users can read videos.
     * @allow (create, update, delete) Authenticated users can create, update, and delete videos.
     * @deny (create, update, delete) Unauthenticated users cannot create, update, or delete videos